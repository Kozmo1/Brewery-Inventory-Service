# Brewery-Inventory-Service

Created by Joel Attard, Shahyar Fida, Mike Kraemer, Julia Lebedzeva

This project is a Node.js-based microservice for inventory management in an e-commerce application, developed as part of a group project for Open Source Web Programming at Conestoga College. It handles adding, fetching, updating, and deleting products, plus stock adjustments, talking to the Brewery Database Service via RESTful APIs. We built it with TypeScript, Express, and Jest to keep it solid, secure, and testable—aiming for 90%+ branch coverage. The service uses `dotenv-safe` to load environment variables from `.env.local` by default or based on `NODE_ENV`. Key settings include the server port (default: 3001), Brewery API URL (default: http://localhost:5089), and an optional JWT secret for auth. The `InventoryController` class drives it all, using Axios for API calls and express-validator for input checks.

To get started, clone the repo from `C:\git\Brewery-Inventory-Service` (or your fork), then run `npm install` to grab dependencies like `express`, `axios`, `jsonwebtoken`, `dotenv-safe`, and `express-validator`. For dev work, add `typescript`, `jest`, `@types/*` packages, and `ts-node` with `npm install --save-dev`. Set up a `.env.local` file with `PORT`, `JWT_SECRET` (optional), `BREWERY_API_URL`, and `NODE_ENV`, using `.env.example` as a guide. Start the service with `npm start` (assuming `ts-node src/index.ts`), or compile with `npm run build` and run `node dist/index.js`. Test it with `npm run test` to hit Jest with coverage—shooting for 100%.

The project’s laid out with `src/config/config.ts` for env setup, `src/controllers/inventoryController.ts` for the core logic, `src/middleware/auth.ts` for JWT checks, and `src/index.ts` to kick things off. Tests are in `src/config/__tests__/config.test.ts` and `src/controllers/__tests__/inventoryController.test.ts`, mocking Axios and express-validator. Below are the endpoints, all under `/inventory` and expecting JSON content type. Protected routes need a Bearer token in the `Authorization` header.

1. `POST /add-product` - Adds a new product (authenticated). Example input: `{"name": "Beer", "type": "Beer", "description": "Tasty", "abv": 5, "volume": 355, "package": "Can", "price": 2.99, "cost": 1.50, "stockQuantity": 100, "reorderPoint": 20}` with header `Authorization: Bearer <token>`. Success response (201): `{"id": 1, "name": "Beer"}`. Error (400): `{"errors": [{"msg": "Name is required"}]}`.
2. `GET /:id` - Fetches a product by ID. Example request: `GET /inventory/1`. Success response (200): `{"id": 1, "name": "Beer"}`. Error (404): `{"message": "Product not found"}`.
3. `PUT /:id` - Updates a product (authenticated). Example input: `{"name": "Updated Beer"}` with header `Authorization: Bearer <token>`. Success response (200): `{"id": 1, "name": "Updated Beer"}`. Error (404): `{"message": "Product not found"}`.
4. `DELETE /:id` - Deletes a product (authenticated). Example request: `DELETE /inventory/1` with header `Authorization: Bearer <token>`. Success response (200): `{"message": "Product deleted successfully"}`. Error (404): `{"message": "Product not found"}`.
5. `GET /` - Lists all products. Example request: `GET /inventory`. Success response (200): `[{"id": 1, "name": "Beer"}, {"id": 2, "name": "Ale"}]`. Error (500): `{"message": "Error fetching products"}`.
6. `PUT /:id/stock` - Updates product stock (authenticated). Example input: `{"quantity": 10}` with header `Authorization: Bearer <token>`. Success response (200): `{"message": "Stock updated successfully", "product": {"id": 1, "name": "Beer", "stockQuantity": 20}}`. Error (400): `{"errors": [{"msg": "Quantity must be an integer"}]}`.
